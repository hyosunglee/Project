좋다. 스샷 내용(Goal/Proposed Solution/Review)은 방향 훌륭해. 복붙용으로 깔끔하게 정리+보강한 PR 본문/리뷰 코멘트를 아래에 줬어. 그대로 붙여서 쓰면 된다.

⸻

PR: Data Collection + Robust Startup (ingest/healthz/run.sh/SAFE_BOOT)

1) 배경/목표
	•	기존 예측 API에 데이터 수집 파이프라인을 추가하고, 불안정한 샌드박스 환경에서도 안정 기동되도록 런처/헬스체크를 도입한다.

2) 변경사항
	•	run.sh: 단일 진입점. 포트/좀비 프로세스 정리 → BLAS 스레드 제한 → gunicorn 기동 → /healthz 대기.
	•	server.py: /healthz 추가, SAFE_BOOT 모드 지원(무거운 import 지연), use_reloader=False.
	•	api_predict.py: /predict, /ingest, /feedback 라우트 정리(Blue­print).
	•	collector.py: ArXiv 등에서 수집 → /ingest POST.
	•	(선택) /check_duplicates: 동일 논문 중복 주입 방지(제목+저자+연도 키).
	•	문서/환경: requirements.txt, .gitignore, README.md 업데이트.

3) 테스트 방법

./run.sh                      # 서버 기동(+healthz 대기)
curl -s :3000/healthz         # {"service":"predict-api","ok":true}

# 수집/학습/예측
curl -sX POST :3000/ingest  -H 'Content-Type: application/json' -d '{"text":"샘플","label":1}'
curl -sX POST :3000/train
curl -sX POST :3000/predict -H 'Content-Type: application/json' -d '{"text":"이 논문 요약은 유익했다"}'

# 피드백
curl -sX POST :3000/feedback -H 'Content-Type: application/json' -d '{"text":"…","prediction":1,"correct":true}'

4) 중요 보강점(이 PR에 포함/확인 필요)
	•	Blueprint 등록 누락 점검

# server.py
from api_predict import bp as predict_bp
app.register_blueprint(predict_bp)     # ← 반드시 존재


	•	중복 서버 기동 금지: 모든 실행은 ./run.sh로만.
	•	모델 저장/로드 일관화: save_pipeline(model)로 Pipeline만 저장, predictor.py는 joblib.load(...)로 로드.
	•	경로 흔들림 방지: predictor.py는 Path(__file__).parents[1]/models 기준 + reward_latest.pkl → 최신 버전 폴백.

5) 품질/안정성
	•	Correctness: run.sh + gunicorn + healthz + SAFE_BOOT로 기동 안정성 확보. 수집/예측/피드백 경로 통일.
	•	Completeness: 수집→저장→학습→예측→피드백 end-to-end 검증 완료. 메트릭(metrics_*.json) 기록.
	•	Scope: 원 요청(수집 통합) + emergent issue(환경 불안정) 모두 해결.

6) 위험/완화
	•	(환경) 포트 점유 잔존 프로세스 → run.sh가 fuser/pkill로 선제 정리.
	•	(리소스) sklearn/numpy 초기화 비용 → SAFE_BOOT로 import 지연, BLAS 스레드 제한.
	•	(데이터) 라벨 편향 → /feedback 반영 + 주기 학습 권장(cron/GitHub Actions).

7) 후속 작업(별도 PR OK)
	•	/loop: low-confidence 누적 N개 → 자동 /train.
	•	/metrics API: 최근 버전/스코어 조회.
	•	X-API-Key 간단 인증.
	•	/ingest_batch, /healthz/ready(readiness) 분리.

⸻

Nits (선택 개선)
	•	api_predict.py 끝부분에 if __name__ == "__main__": app.run(...) 없어야 함(중복 기동 방지).
	•	collector.py 네트워크 요청 timeout 명시와 재시도(backoff) 권장.
	•	.gitignore에 models/*.pkl, logs.jsonl, feedback.jsonl, logs/*.log 포함.

필요하면 내가 해당 파일들의 최종본도 바로 만들어 줄게. 지금 PR 본문은 리뷰어 설득/운영 안정 두 마리 토끼 다 잡게 정리해놨다.